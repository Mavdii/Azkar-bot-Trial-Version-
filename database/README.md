# ๐ Database Migrations - ุชุฑุญููุงุช ูุงุนุฏุฉ ุงูุจูุงูุงุช

ูุฐุง ุงููุฌูุฏ ูุญุชูู ุนูู ุชุฑุญููุงุช ูุงุนุฏุฉ ุงูุจูุงูุงุช ูููุธุงู ุงููุญุณู ูููุงููุช ุงูุตูุงุฉ.

## ๐ ุงูุชุฑุญููุงุช ุงููุชุงุญุฉ

### 001_prayer_times_cache.sql
- **ุงููุฏู:** ุฅูุดุงุก ุฌุฏูู ุงูุชุฎุฒูู ุงููุคูุช ูููุงููุช ุงูุตูุงุฉ
- **ุงููุญุชูู:**
  - ุฌุฏูู `prayer_times_cache` ูุญูุธ ุงูููุงููุช
  - ููุงุฑุณ ููุฃุฏุงุก ุงูุฃูุซู
  - ุฏุงูุฉ ุชูุธูู ุงูุจูุงูุงุช ุงูููุชููุฉ ุงูุตูุงุญูุฉ
  - ูููุฉ ุชูุธูู ุชููุงุฆูุฉ

### 002_enhanced_group_settings.sql
- **ุงููุฏู:** ุชุญุณูู ุฌุฏูู ุฅุนุฏุงุฏุงุช ุงููุฌููุนุงุช
- **ุงููุญุชูู:**
  - ุฅุถุงูุฉ ุฃุนูุฏุฉ ุฌุฏูุฏุฉ ููุฅุนุฏุงุฏุงุช ุงููุชูุฏูุฉ
  - ูููุฏ ููุชุญูู ูู ุตุญุฉ ุงูุจูุงูุงุช
  - ููุงุฑุณ ููุงุณุชุนูุงูุงุช ุงูุณุฑูุนุฉ
  - trigger ูุชุญุฏูุซ ููุช ุงูุชุนุฏูู ุชููุงุฆูุงู

### 003_monitoring_tables.sql
- **ุงููุฏู:** ุฅูุดุงุก ุฌุฏุงูู ุงููุฑุงูุจุฉ ูุงูุฅุญุตุงุฆูุงุช
- **ุงููุญุชูู:**
  - ุฌุฏูู `error_logs` ูุณุฌู ุงูุฃุฎุทุงุก
  - ุฌุฏูู `performance_metrics` ูููุงููุณ ุงูุฃุฏุงุก
  - ุฌุฏูู `health_checks` ููุญูุตุงุช ุงูุตุญุฉ
  - ุฌุฏูู `alerts` ููุชูุจููุงุช
  - ุฌุฏูู `system_statistics` ููุฅุญุตุงุฆูุงุช ุงูุนุงูุฉ
  - ุฏูุงู ูุณุงุนุฏุฉ ููุชูุธูู ูุงูุชุญููู

## ๐ ุชุดุบูู ุงูุชุฑุญููุงุช

### ุงูุทุฑููุฉ ุงูุฃููู: ุงุณุชุฎุฏุงู ุงููููุฐ ุงูุขูู
```bash
python database/run_migrations.py
```

### ุงูุทุฑููุฉ ุงูุซุงููุฉ: ุชุดุบูู ูุฏูู
```bash
# ุชุดุบูู ูู ุชุฑุญูู ุนูู ุญุฏุฉ
psql -h your_host -d your_database -f database/migrations/001_prayer_times_cache.sql
psql -h your_host -d your_database -f database/migrations/002_enhanced_group_settings.sql
psql -h your_host -d your_database -f database/migrations/003_monitoring_tables.sql
```

### ุงูุทุฑููุฉ ุงูุซุงูุซุฉ: Supabase Dashboard
1. ุงูุชุญ Supabase Dashboard
2. ุงุฐูุจ ุฅูู SQL Editor
3. ุงูุณุฎ ูุงูุตู ูุญุชูู ูู ููู ุชุฑุญูู
4. ุดุบู ุงูุงุณุชุนูุงูุงุช ุจุงูุชุฑุชูุจ

## โ๏ธ ูุชุทูุจุงุช ุงูุชุดุบูู

### ูุชุบูุฑุงุช ุงูุจูุฆุฉ ุงููุทููุจุฉ
```bash
SUPABASE_URL=your_supabase_project_url
SUPABASE_KEY=your_supabase_anon_key
# ุฃู
SUPABASE_SERVICE_KEY=your_supabase_service_key  # ููุนูููุงุช ุงูุฅุฏุงุฑูุฉ
```

### ุงูููุชุจุงุช ุงููุทููุจุฉ
```bash
pip install supabase
pip install psycopg2-binary  # ููุงุชุตุงู ุงููุจุงุดุฑ ุจู PostgreSQL
```

## ๐ ูููู ูุงุนุฏุฉ ุงูุจูุงูุงุช ุจุนุฏ ุงูุชุฑุญูู

### ุงูุฌุฏุงูู ุงูุฌุฏูุฏุฉ
- `prayer_times_cache` - ุงูุชุฎุฒูู ุงููุคูุช ููููุงููุช
- `error_logs` - ุณุฌู ุงูุฃุฎุทุงุก
- `performance_metrics` - ููุงููุณ ุงูุฃุฏุงุก
- `health_checks` - ูุญูุตุงุช ุงูุตุญุฉ
- `alerts` - ุงูุชูุจููุงุช
- `system_statistics` - ุงูุฅุญุตุงุฆูุงุช ุงูุนุงูุฉ
- `schema_migrations` - ุชุชุจุน ุงูุชุฑุญููุงุช

### ุงูุฌุฏุงูู ุงููุญุฏุซุฉ
- `group_settings` - ุฅุนุฏุงุฏุงุช ูุญุณูุฉ ูููุฌููุนุงุช

## ๐ง ุงูุฏูุงู ุงููุณุงุนุฏุฉ

### ุฏูุงู ุงูุชูุธูู
- `cleanup_expired_prayer_times()` - ุชูุธูู ุงูููุงููุช ุงูููุชููุฉ ุงูุตูุงุญูุฉ
- `cleanup_monitoring_data()` - ุชูุธูู ุจูุงูุงุช ุงููุฑุงูุจุฉ ุงููุฏููุฉ

### ุฏูุงู ุงูุชุญููู
- `get_system_health_summary()` - ููุฎุต ุตุญุฉ ุงููุธุงู

## ๐ ุงูููุงุฑุณ ุงููุถุงูุฉ

### ููุงุฑุณ ุงูุฃุฏุงุก
- ููุงุฑุณ ุงูุชุงุฑูุฎ ูุงูููุช ููุงุณุชุนูุงูุงุช ุงูุณุฑูุนุฉ
- ููุงุฑุณ ุงูุญุงูุฉ ููููุชุฑุฉ ุงููุนุงูุฉ
- ููุงุฑุณ ุงูููููุงุช ููุชุฌููุน

### ููุงุฑุณ ุงูุชุญุณูู
- ููุงุฑุณ ูููุฌููุนุงุช ุงููุดุทุฉ
- ููุงุฑุณ ููุฅุนุฏุงุฏุงุช ุงูููุนูุฉ
- ููุงุฑุณ ููุจูุงูุงุช ุงูุญุฏูุซุฉ

## ๐ก๏ธ ุงูุฃูุงู ูุงูุตูุงุญูุงุช

### ุตูุงุญูุงุช ูุทููุจุฉ
- `CREATE TABLE` - ูุฅูุดุงุก ุงูุฌุฏุงูู ุงูุฌุฏูุฏุฉ
- `ALTER TABLE` - ูุชุนุฏูู ุงูุฌุฏุงูู ุงูููุฌูุฏุฉ
- `CREATE INDEX` - ูุฅูุดุงุก ุงูููุงุฑุณ
- `CREATE FUNCTION` - ูุฅูุดุงุก ุงูุฏูุงู ุงููุณุงุนุฏุฉ
- `CREATE TRIGGER` - ูุฅูุดุงุก ุงููุญูุฒุงุช

### ุงุนุชุจุงุฑุงุช ุงูุฃูุงู
- ุงุณุชุฎุฏู `SUPABASE_SERVICE_KEY` ููุนูููุงุช ุงูุฅุฏุงุฑูุฉ
- ุชุฃูุฏ ูู ุตุญุฉ ุงูุงุชุตุงู ูุจู ุงูุชุดุบูู
- ุงุญุชูุธ ุจูุณุฎุฉ ุงุญุชูุงุทูุฉ ูุจู ุงูุชุดุบูู

## ๐ ุงูุชุฑุงุฌุน ุนู ุงูุชุฑุญููุงุช

ูู ุญุงูุฉ ุงูุญุงุฌุฉ ููุชุฑุงุฌุน:

```sql
-- ุญุฐู ุงูุฌุฏุงูู ุงูุฌุฏูุฏุฉ
DROP TABLE IF EXISTS prayer_times_cache CASCADE;
DROP TABLE IF EXISTS error_logs CASCADE;
DROP TABLE IF EXISTS performance_metrics CASCADE;
DROP TABLE IF EXISTS health_checks CASCADE;
DROP TABLE IF EXISTS alerts CASCADE;
DROP TABLE IF EXISTS system_statistics CASCADE;

-- ุฅุฒุงูุฉ ุงูุฃุนูุฏุฉ ุงููุถุงูุฉ ูุฌุฏูู group_settings
ALTER TABLE group_settings 
DROP COLUMN IF EXISTS quran_send_delay_minutes,
DROP COLUMN IF EXISTS prayer_timezone,
DROP COLUMN IF EXISTS prayer_alert_minutes,
DROP COLUMN IF EXISTS last_prayer_update,
DROP COLUMN IF EXISTS created_at,
DROP COLUMN IF EXISTS updated_at;
```

## ๐ ุงูุฏุนู ูุงููุณุงุนุฏุฉ

ูู ุญุงูุฉ ููุงุฌูุฉ ูุดุงูู:

1. **ุชุญูู ูู ุงูุณุฌูุงุช:** ุฑุงุฌุน ุณุฌูุงุช ุงูุชุดุบูู ููุฃุฎุทุงุก
2. **ุชุญูู ูู ุงูุตูุงุญูุงุช:** ุชุฃูุฏ ูู ูุฌูุฏ ุงูุตูุงุญูุงุช ุงููุทููุจุฉ
3. **ุชุญูู ูู ุงูุงุชุตุงู:** ุชุฃูุฏ ูู ุตุญุฉ ุงุชุตุงู ูุงุนุฏุฉ ุงูุจูุงูุงุช
4. **ุงููุณุฎ ุงูุงุญุชูุงุทูุฉ:** ุชุฃูุฏ ูู ูุฌูุฏ ูุณุฎุฉ ุงุญุชูุงุทูุฉ ูุจู ุงูุชุดุบูู

## ๐ ููุงุญุธุงุช ูููุฉ

- **ุงูุชุฑุชูุจ ููู:** ูุฌุจ ุชุดุบูู ุงูุชุฑุญููุงุช ุจุงูุชุฑุชูุจ ุงููุญุฏุฏ
- **ุงููุณุฎ ุงูุงุญุชูุงุทูุฉ:** ุงุญุชูุธ ุจูุณุฎุฉ ุงุญุชูุงุทูุฉ ูุจู ุงูุชุดุบูู
- **ุงูุจูุฆุฉ:** ุงุฎุชุจุฑ ูู ุจูุฆุฉ ุงูุชุทููุฑ ุฃููุงู
- **ุงููุฑุงูุจุฉ:** ุฑุงูุจ ุงูุฃุฏุงุก ุจุนุฏ ุงูุชุดุบูู

## ๐ฏ ุงูุฎุทูุงุช ุงูุชุงููุฉ

ุจุนุฏ ุชุดุบูู ุงูุชุฑุญููุงุช:

1. **ุงุฎุชุจุงุฑ ุงููุธุงู:** ุชุฃูุฏ ูู ุนูู ุฌููุน ุงููุธุงุฆู
2. **ูุฑุงูุจุฉ ุงูุฃุฏุงุก:** ุฑุงูุจ ุฃุฏุงุก ูุงุนุฏุฉ ุงูุจูุงูุงุช
3. **ุชุญุฏูุซ ุงูุชุทุจูู:** ุญุฏุซ ููุฏ ุงูุชุทุจูู ูุงุณุชุฎุฏุงู ุงูุฌุฏุงูู ุงูุฌุฏูุฏุฉ
4. **ุงูุชูุซูู:** ุญุฏุซ ุงูุชูุซูู ููุนูุณ ุงูุชุบููุฑุงุช